# üìã –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–≤ –≤ BPMN –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–µ–∫-–ª–∏—Å—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —á–µ–∫-–ª–∏—Å—Ç—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç–æ–≤ StormBPMN –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∏—Ö –≤ Camunda BPMN —Å—Ö–µ–º—ã. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ–∫-–ª–∏—Å—Ç–æ–≤ –∏–∑ Bitrix24 –∑–∞–¥–∞—á.

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü–∞—Ä—Å–∏–Ω–≥ –æ–ø–∏—Å–∞–Ω–∏–π**: –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ª–µ `description` –∏–∑ —Ñ–∞–π–ª–∞ `*_assignees.json`
2. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–≤**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ChecklistParser` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —á–µ–∫-–ª–∏—Å—Ç–æ–≤
3. **–í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –≤ BPMN**: –î–æ–±–∞–≤–ª—è–µ—Ç —á–µ–∫-–ª–∏—Å—Ç—ã –∫–∞–∫ —Å–≤–æ–π—Å—Ç–≤–æ `checklists` –≤ `camunda:properties` –∫–∞–∂–¥–æ–≥–æ `serviceTask`

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

### –°—Å—ã–ª–∫–∞ –Ω–∞ Bitrix24 (–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô)
```html
<p>–ß–ï–ö–õ–ò–°–¢: <a href="https://bx.eg-holding.ru/tasks/task/view/1566/">—Å—Å—ã–ª–∫–∞</a></p>
```
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —á–µ–∫-–ª–∏—Å—Ç—ã –∏–∑ Bitrix24 –∑–∞–¥–∞—á–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —á–µ–∫-–ª–∏—Å—Ç–æ–≤

### –î—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã
- `–ß–ï–ö–õ–ò–°–¢: –ù–∞–∑–≤–∞–Ω–∏–µ ‚Ä¢ –ü—É–Ω–∫—Ç 1 ‚Ä¢ –ü—É–Ω–∫—Ç 2`
- HTML —Å–ø–∏—Å–∫–∏ —Å —Ç–µ–≥–∞–º–∏ `<ul>` –∏ `<li>`
- –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ `**`, `@`, `#`, `‚Äì`

## –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ß–µ–∫-–ª–∏—Å—Ç—ã –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ BPMN –∫–∞–∫ JSON –º–∞—Å—Å–∏–≤ –≤ —Å–≤–æ–π—Å—Ç–≤–µ `checklists`:

```json
[
  {
    "name": "–ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö",
    "items": ["–±—Ä–æ–Ω–∏", "–î–î–£ –∏ –î–ö–ü"]
  },
  {
    "name": "–î–æ–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ –£–£", 
    "items": ["–±—Ä–æ–Ω–∏"]
  }
]
```

## –ü—Ä–∏–º–µ—Ä –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è –≤ BPMN

```xml
<bpmn:serviceTask id="Activity_1nptpu5" name="–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º –î–î–£ –∏ –î–ö–ü –≤ –£–£" 
                  camunda:type="external" camunda:topic="bitrix_create_task">
  <bpmn:extensionElements>
    <camunda:properties>
      <camunda:property name="assigneeName" value="–ò–≤–∞–Ω–æ–≤ –ò.–ò." />
      <camunda:property name="assigneeId" value="12345" />
      <camunda:property name="checklists" 
                        value="[{&quot;name&quot;:&quot;–ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö&quot;,&quot;items&quot;:[&quot;–±—Ä–æ–Ω–∏&quot;,&quot;–î–î–£ –∏ –î–ö–ü&quot;]}]" />
    </camunda:properties>
  </bpmn:extensionElements>
</bpmn:serviceTask>
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
python test_checklist_integration.py
```

–°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ assignees.json
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —á–µ–∫-–ª–∏—Å—Ç–æ–≤ –∏–∑ –æ–ø–∏—Å–∞–Ω–∏–π
- ‚úÖ –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–≤ –≤ BPMN XML
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å JSON —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
üéâ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç! –í—Å—Ç—Ä–æ–µ–Ω–æ —á–µ–∫-–ª–∏—Å—Ç–æ–≤ –≤ 1 –∑–∞–¥–∞—á

Activity_1nptpu5: 4 —á–µ–∫-–ª–∏—Å—Ç–æ–≤, 10 –ø—É–Ω–∫—Ç–æ–≤
   üìã –ü—Ä–∏–º–µ—Ä: '–ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö' - 2 –ø—É–Ω–∫—Ç–æ–≤
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Bitrix24 –∏–∑ `task-creator.py/consumers/bitrix/config.py`.

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `BITRIX_WEBHOOK_URL` - URL webhook Bitrix24
- `BITRIX_REQUEST_TIMEOUT` - –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 —Å–µ–∫)

## –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–≤–µ—Ä—Å–∏—è 2.0)

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–ø—Ä–æ—â–µ–Ω–∏—è:
- ‚úÖ **–ü—Ä—è–º–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è**: `extract_checklists_for_camunda()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
- ‚úÖ **–ù–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π**: —É–±—Ä–∞–Ω –º–µ—Ç–æ–¥ `_format_checklists_for_camunda()`
- ‚úÖ **–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π JSON**: –º–∞—Å—Å–∏–≤ –±–µ–∑ –ª–∏—à–Ω–µ–π –æ–±—ë—Ä—Ç–∫–∏ `{"checklists": [...]}`
- ‚úÖ **–û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –æ–¥–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
```json
[{"name":"–ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö","items":["–±—Ä–æ–Ω–∏","–î–î–£ –∏ –î–ö–ü"]},{"name":"–î–æ–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ –£–£","items":["–±—Ä–æ–Ω–∏"]}]
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **BPMNConverter** (`camunda-sync.py/bpmn_converter.py`)
   - –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ BPMN —Å—Ö–µ–º
   - –ú–µ—Ç–æ–¥ `_add_checklist_properties()` –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–≤

2. **ChecklistParser** (`camunda-sync.py/tools/checklist_parser.py`)
   - –ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —á–µ–∫-–ª–∏—Å—Ç–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Bitrix24 API
   - –ú–µ—Ç–æ–¥ `extract_checklists_for_camunda()` –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. `convert_file()` - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
2. `_add_assignee_properties()` - –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
3. **`_add_checklist_properties()`** - **–≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–≤** ‚≠ê
4. `_add_condition_expressions()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π
5. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏...

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- ‚ö†Ô∏è –ï—Å–ª–∏ ChecklistParser –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–≤
- ‚ö†Ô∏è –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö assignees - –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ
- ‚ö†Ô∏è –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å
- ‚ö†Ô∏è –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö Bitrix24 API - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ß–µ–∫-–ª–∏—Å—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–∞—Ä—Å–∏–Ω–≥–∞
- –ú–∞–∫—Å–∏–º—É–º 20 –ø—É–Ω–∫—Ç–æ–≤ –Ω–∞ —á–µ–∫-–ª–∏—Å—Ç (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- –¢–∞–π–º–∞—É—Ç Bitrix24 API: 30 —Å–µ–∫—É–Ω–¥

---

*–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å–∏—Å—Ç–µ–º–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–µ–∫-–ª–∏—Å—Ç–æ–≤*
