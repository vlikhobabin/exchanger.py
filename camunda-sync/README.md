# Camunda-StormBPMN Sync Service

–°–µ—Ä–≤–∏—Å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ BPMN –¥–∏–∞–≥—Ä–∞–º–º –º–µ–∂–¥—É StormBPMN (https://stormbpmn.com) –∏ Camunda (https://camunda.eg-holding.ru).

## –û–ø–∏—Å–∞–Ω–∏–µ

–î–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–µ—Ä–µ–Ω–æ—Å–∞ BPMN –¥–∏–∞–≥—Ä–∞–º–º –∏–∑ –æ–±–ª–∞—á–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã StormBPMN –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É Camunda —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –æ–± –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–∏–∞–≥—Ä–∞–º–º** –∏–∑ StormBPMN —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ BPMN —Å—Ö–µ–º** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º XML –∏ —Å–ø–∏—Å–∫–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è** StormBPMN ‚Üí Camunda —Ñ–æ—Ä–º–∞—Ç —Å –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
- **–î–µ–ø–ª–æ–π —Å–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ö–µ–º** –≤ Camunda —á–µ—Ä–µ–∑ REST API

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

#### –ö–ª–∞—Å—Å—ã:
- **`StormBPMNClient`** (`stormbpmn_client.py`) - —Ä–∞–±–æ—Ç–∞ —Å API StormBPMN
- **`BPMNConverter`** (`bpmn_converter.py`) - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è BPMN —Å—Ö–µ–º
- **`CamundaClient`** (`camunda_client.py`) - —Ä–∞–±–æ—Ç–∞ —Å Camunda REST API

#### –°–µ—Ä–≤–∏—Å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
- **`get_diagrams_list.py`** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- **`get_diagram_xml.py`** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
- **`convert.py`** - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å—Ö–µ–º—ã –¥–ª—è Camunda
- **`deploy.py`** - –¥–µ–ø–ª–æ–π —Å—Ö–µ–º—ã –≤ Camunda

## –û—Å–Ω–æ–≤–Ω–æ–π Workflow

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö BPMN –¥–∏–∞–≥—Ä–∞–º–º –∏–∑ StormBPMN —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

**–ö–ª–∞—Å—Å**: `StormBPMNClient`
**–ú–µ—Ç–æ–¥—ã**: 
- `get_diagrams_list(size=20, page=0, **filters)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

**–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç**: `tools/get_diagrams_list.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
# cd tools
py camunda-sync.py/tools/get_diagrams_list.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: JSON —Å–ø–∏—Å–æ–∫ –¥–∏–∞–≥—Ä–∞–º–º —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (–Ω–∞–∑–≤–∞–Ω–∏–µ, ID, –∞–≤—Ç–æ—Ä, –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞**:
```json
{
  "content": [
    {
      "id": "9d5687e5-6108-4f05-b46a-2d24b120ba9d",
      "name": "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏",
      "status": "IN_PROGRESS",
      "authorUsername": "user@company.com",
      "updatedOn": "2024-01-15T10:30:00Z"
    }
  ],
  "totalElements": 197,
  "totalPages": 10
}
```

---

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ ID

**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ BPMN XML –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ —Å–ø–∏—Å–∫–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ GUID —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

**–ö–ª–∞—Å—Å**: `StormBPMNClient`
**–ú–µ—Ç–æ–¥—ã**: 
- `get_diagram_by_id(diagram_id)` - –ø–æ–ª—É—á–µ–Ω–∏–µ BPMN XML
- `get_diagram_assignees(diagram_id)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö

**–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç**: `tools/get_diagram_xml.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
cd tools
python get_diagram_xml.py 9d5687e5-6108-4f05-b46a-2d24b120ba9d
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –§–∞–π–ª `{–Ω–∞–∑–≤–∞–Ω–∏–µ_–¥–∏–∞–≥—Ä–∞–º–º—ã}.bpmn` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ **—Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏**
- –§–∞–π–ª `{–Ω–∞–∑–≤–∞–Ω–∏–µ_–¥–∏–∞–≥—Ä–∞–º–º—ã}_assignees.json` —Å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º–∏

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)**:
–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã (ID, –Ω–∞–∑–≤–∞–Ω–∏–µ, —Å—Ç–∞—Ç—É—Å, –∞–≤—Ç–æ—Ä –∏ –¥—Ä.) –≤ —ç–ª–µ–º–µ–Ω—Ç `<bpmn:process>` —á–µ—Ä–µ–∑ `<bpmn:extensionElements>` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å BPMN 2.0 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ Camunda –∏ –∏–∑–±–µ–≥–∞–µ—Ç –æ—à–∏–±–æ–∫ —Ç–∏–ø–∞ ENGINE-09005.

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**:
```
üìÅ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞_–∏_–ø–æ–ª—É—á–µ–Ω–∏–µ_—Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ–π_–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.bpmn
üìÅ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞_–∏_–ø–æ–ª—É—á–µ–Ω–∏–µ_—Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ–π_–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏_assignees.json
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ _assignees.json**:
```json
[
  {
    "assigneeEdgeId": 15700296,
    "assigneeName": "–†—É–∫.–æ—Ç–¥. –∞—Ä—Ö.—Å–æ–ø—Ä. –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤",
    "assigneeId": 15298311,
    "elementId": "Activity_1597r5e",
    "elementName": "–ü–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É",
    "assigneeType": "HUMAN",
    "duration": 900
  }
]
```

---

### 3. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å—Ö–µ–º—ã –¥–ª—è Camunda

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ BPMN —Å—Ö–µ–º—ã –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ StormBPMN –≤ —Ñ–æ—Ä–º–∞—Ç Camunda —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö.

**–ö–ª–∞—Å—Å**: `BPMNConverter`
**–ú–µ—Ç–æ–¥—ã**: 
- `convert_file(input_file, assignees_data=None)` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö

**–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç**: `tools/convert.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
cd tools
python convert.py ../–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞_–∏_–ø–æ–ª—É—á–µ–Ω–∏–µ_—Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ–π_–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.bpmn
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞**:
1. –ò—â–µ—Ç —Ñ–∞–π–ª `{–Ω–∞–∑–≤–∞–Ω–∏–µ}_assignees.json` —Ä—è–¥–æ–º —Å BPMN —Ñ–∞–π–ª–æ–º
2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤ serviceTask —ç–ª–µ–º–µ–Ω—Ç—ã
3. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–ª—è Camunda

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –§–∞–π–ª `camunda_{–Ω–∞–∑–≤–∞–Ω–∏–µ_–¥–∏–∞–≥—Ä–∞–º–º—ã}.bpmn` –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –¥–µ–ø–ª–æ—è

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è**:
- –í—Å–µ –∑–∞–¥–∞—á–∏ ‚Üí `serviceTask` —Å `camunda:type="external"` –∏ `camunda:topic="bitrix_create_task"`
- –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π —Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ—Ç–æ–∫–æ–≤
- –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–∞–∫ `camunda:properties`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–≤** –∏–∑ –æ–ø–∏—Å–∞–Ω–∏–π –∑–∞–¥–∞—á Bitrix24 –∫–∞–∫ `camunda:properties`
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤ "–¥–∞"/"–Ω–µ—Ç"
- –í—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–∞–¥–∞—á –º–µ–∂–¥—É —à–ª—é–∑–∞–º–∏ –¥–ª—è —Ä–∞–∑—Ä—ã–≤–∞ —Ü–µ–ø–æ—á–µ–∫ Gateway ‚Üí Gateway
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ BPMN —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ID –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö `custom:diagram`

**–í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–≤ (–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è)**:
–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ù–∞—Ö–æ–¥–∏—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å ID –∑–∞–¥–∞—á Bitrix24 –≤ –æ–ø–∏—Å–∞–Ω–∏—è—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —á–µ–∫-–ª–∏—Å—Ç—ã –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞—á Bitrix24 —á–µ—Ä–µ–∑ REST API
3. –ü–∞—Ä—Å–∏—Ç —á–µ–∫-–ª–∏—Å—Ç—ã –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç
4. –í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–∞–∫ `camunda:property` —Å –∏–º–µ–Ω–µ–º `checklists` –≤ –∫–∞–∂–¥—ã–π `serviceTask`

**–ü—Ä–∏–º–µ—Ä –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —á–µ–∫-–ª–∏—Å—Ç–∞**:
```xml
<camunda:property name="checklists" value='[{"name":"–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤","items":["–ü–∞—Å–ø–æ—Ä—Ç","–ò–ù–ù","–°–ù–ò–õ–°"]}]' />
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞**:
–¢–µ–ø–µ—Ä—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã (ID, –Ω–∞–∑–≤–∞–Ω–∏–µ, —Å—Ç–∞—Ç—É—Å) –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ —ç–ª–µ–º–µ–Ω—Ç `<bpmn:process>` —á–µ—Ä–µ–∑ `<bpmn:extensionElements>`, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç BPMN 2.0 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:
```xml
<bpmn:process id="Process_extracted_from_metadata" name="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑ StormBPMN">
  <bpmn:extensionElements>
    <custom:diagram>
      <custom:id>3f946f12-5071-4a9f-9960-0f57b4c05e45</custom:id>
      <custom:name>–ü—Ä–æ—Ü–µ—Å—Å—ã –£–£. –ú–æ–¥–µ–ª—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏</custom:name>
      <!-- ... –¥—Ä—É–≥–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ... -->
    </custom:diagram>
  </bpmn:extensionElements>
  <!-- ... —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ ... -->
</bpmn:process>
```

---

### 4. –î–µ–ø–ª–æ–π —Å—Ö–µ–º—ã –≤ Camunda

**–û–ø–∏—Å–∞–Ω–∏–µ**: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π BPMN —Å—Ö–µ–º—ã –≤ Camunda Platform.

**–ö–ª–∞—Å—Å**: `CamundaClient`
**–ú–µ—Ç–æ–¥—ã**: 
- `deploy_diagram(bpmn_file_path, deployment_name=None)` - –¥–µ–ø–ª–æ–π —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ –¥–µ–ø–ª–æ—è

**–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç**: `tools/deploy.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
cd tools
python deploy.py ../camunda_–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞_–∏_–ø–æ–ª—É—á–µ–Ω–∏–µ_—Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ–π_–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.bpmn
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –ù–æ–≤—ã–π deployment –≤ Camunda
- –ê–∫—Ç–∏–≤–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≥–æ—Ç–æ–≤—ã–µ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞**:
```
üéâ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
üÜî ID –¥–µ–ø–ª–æ—è: 12345678-1234-5678-9012-123456789012
üìã –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (1):
   üìã –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
      Key: Process_1d4oa6g46
      Version: 3
      –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π: ‚úÖ –î–∞
```

## –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä workflow

```bash
# 1. –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
cd camunda-sync.py/tools
python get_diagrams_list.py

# 2. –°–∫–∞—á–∏–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ö–µ–º—É —Å –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID)
python get_diagram_xml.py 9d5687e5-6108-4f05-b46a-2d24b120ba9d

# 3. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –¥–ª—è Camunda 
#    ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –∏ –≤—Å—Ç—Ä–æ–∏—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
#    ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç –∏ –≤—Å—Ç—Ä–æ–∏—Ç —á–µ–∫-–ª–∏—Å—Ç—ã –∏–∑ Bitrix24
#    ‚úÖ –ò–∑–≤–ª–µ—á–µ—Ç ID –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö 
python convert.py ../–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞_–∏_–ø–æ–ª—É—á–µ–Ω–∏–µ_—Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ–π_–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.bpmn

# 4. –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –≤ Camunda (—Ç–µ–ø–µ—Ä—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å BPMN 2.0)
python deploy.py ../camunda_–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞_–∏_–ø–æ–ª—É—á–µ–Ω–∏–µ_—Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ–π_–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.bpmn
```

**–ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ workflow:**
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ (`<bpmn:process>`) —Å–æ–≥–ª–∞—Å–Ω–æ BPMN 2.0
- ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ Bitrix24 –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ –∑–∞–¥–∞—á–∏
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ ENGINE-09005 –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ Camunda  
- ‚úÖ –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –º–µ–∂–¥—É —à–ª—é–∑–∞–º–∏

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –±–µ–∑ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è XML:

```bash
cd tools
python get_diagram_assignees.py 9d5687e5-6108-4f05-b46a-2d24b120ba9d
```

–í—ã–≤–æ–¥–∏—Ç JSON + –∫—Ä–∞—Ç–∫—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd ..
pip install -r requirements.txt
```

### 2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `../config.env.example` –≤ `../.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# StormBPMN API
STORMBPMN_BEARER_TOKEN=your_bearer_token_here

# Camunda API  
CAMUNDA_BASE_URL=https://camunda.eg-holding.ru/engine-rest
CAMUNDA_AUTH_USERNAME=your_username
CAMUNDA_AUTH_PASSWORD=your_password

# Bitrix24 API (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–≤)
BITRIX24_WEBHOOK_URL=https://your-bitrix.bitrix24.ru/rest/1/webhook_key/
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: Bitrix24 API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —á–µ–∫-–ª–∏—Å—Ç–æ–≤ –∏–∑ –∑–∞–¥–∞—á. –ï—Å–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ —á–µ–∫-–ª–∏—Å—Ç–æ–≤.

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ Bearer Token

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://stormbpmn.com –∏ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
2. F12 ‚Üí Network ‚Üí –ª—é–±–æ–π –∑–∞–ø—Ä–æ—Å –∫ API
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization: Bearer ...`

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

```bash
cd tools
# –¢–µ—Å—Ç StormBPMN API
python get_diagrams_list.py

# –¢–µ—Å—Ç Camunda API  
python deploy.py --test  # (–µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é)

# –¢–µ—Å—Ç –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–≤ - –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –ª—é–±–æ–π —Å—Ö–µ–º—ã
# –í –ª–æ–≥–∞—Ö –±—É–¥—É—Ç –≤–∏–¥–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –∫ Bitrix24 API
python convert.py ../test_diagram.bpmn
```

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**ENGINE-09005 –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ Camunda:**
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `<bpmn:process>`, –∞ –Ω–µ –≤ `<bpmn:definitions>`

**–ß–µ–∫-–ª–∏—Å—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É `BITRIX24_WEBHOOK_URL` –≤ `.env` —Ñ–∞–π–ª–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –æ–ø–∏—Å–∞–Ω–∏—è—Ö –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –µ—Å—Ç—å ID –∑–∞–¥–∞—á Bitrix24
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ webhook –∫ –∑–∞–¥–∞—á–∞–º –≤ Bitrix24

**–û—à–∏–±–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–π BPMN —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ `get_diagram_xml.py` —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ `*_assignees.json` —Ä—è–¥–æ–º —Å BPMN —Ñ–∞–π–ª–æ–º

### –õ–æ–≥–∏

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—à–∏–±–∫–∞—Ö –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º. –û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å Bitrix24 API –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–≤.

## API Reference

### StormBPMNClient

- `get_diagrams_list(size=20, page=0, **filters)` - —Å–ø–∏—Å–æ–∫ –¥–∏–∞–≥—Ä–∞–º–º
- `get_diagram_by_id(diagram_id)` - –¥–∞–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Å BPMN XML
- `get_diagram_assignees(diagram_id)` - —Å–ø–∏—Å–æ–∫ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö

### BPMNConverter

- `convert_file(input_file, assignees_data=None)` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ–º

### CamundaClient  

- `deploy_diagram(bpmn_file_path, deployment_name=None)` - –¥–µ–ø–ª–æ–π
- `get_deployments(limit=10)` - —Å–ø–∏—Å–æ–∫ –¥–µ–ø–ª–æ–µ–≤
- `test_connection()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å Bearer token –¥–ª—è StormBPMN
2. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Camunda —Å–µ—Ä–≤–µ—Ä–∞  
3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ .env
4. **–ù–∞—Å—Ç—Ä–æ–π–∫—É Bitrix24 webhook** –¥–ª—è —á–µ–∫-–ª–∏—Å—Ç–æ–≤
5. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å BPMN —Ñ–∞–π–ª–æ–≤** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã, —Å–∫–∞—á–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `get_diagram_xml.py`
6. –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π 